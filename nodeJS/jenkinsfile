pipeline {
    agent any
    environment {
        SONARQUBE_SERVER = 'SonarQubeLocal' // Your SonarQube configuration in Jenkins
    }
    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('SonarQube Analysis') {
            steps {
                withSonarQubeEnv(SONARQUBE_SERVER) {
                    // Run SonarScanner in Docker
                    sh '''
                    docker run --rm \
                        -v $PWD:/usr/src \
                        -v sonar-cache:/root/.sonar \
                        sonarsource/sonar-scanner-cli \
                        -Dsonar.projectKey=AI-Emergency \
                        -Dsonar.sources=/usr/src
                    '''
                }
            }
        }
    }
}
